<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="eyetools">
<title>An introduction to eyetools • eyetools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to eyetools">
<meta property="og:description" content="eyetools">
<meta property="og:image" content="https://tombeesley.github.io/eyetools/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">eyetools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/eyetools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Animating-eyetools-data.html">Animating eyetools data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>An introduction to eyetools</h1>
                        <h4 data-toc-skip class="author">Matthew Ivory,
Tom Beesley</h4>
            
      
      
      <div class="d-none name"><code>eyetools.Rmd</code></div>
    </div>

    
    
<p>The eyetools package can help to standardise and speed up the eye
data analysis, particularly in the exploratory and data manipulation
stages. The suite of functions available can be used to go from
relatively unprocessed data to analysis-ready. For the purpose of this
tutorial, we will start with a dataset that contains eye data from three
participants in a task CAN WE ADD DETAIL ON THE TASK AND WHAT IT WAS
ABOUT?</p>
<p>You can install eyetools using the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"tombeesley/eyetools"</span><span class="op">)</span></span></code></pre></div>
<p>A quick note before starting: the following tutorial is written using
only the dependencies contained within eyetools, so that means that if
you are planning on following this tutorial through, you only need to
install eyetools.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tombeesley.github.io/eyetools/">eyetools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>To begin with, let us load in the data and have an initial
exploration of this basic format data. As we can see, the dataset is
over 462,000 rows and 7 observations</p>
<div class="section level2">
<h2 id="data-manipulation-and-preprocessing">Data Manipulation and Preprocessing<a class="anchor" aria-label="anchor" href="#data-manipulation-and-preprocessing"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#this load will be hidden away and a nicer version of presenting this data will be written in</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"data/data_for_eyetools.RData"</span><span class="op">)</span> <span class="co"># imports as 'data' - eye tracking data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"data/data_for_eyetools 1.rdata"</span><span class="op">)</span> <span class="co"># imports as 'td' - behavioural data # actually loads both, these need resaving...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 462577      7</span></span></code></pre>
<p>To get a basic idea of the contents of the data, we can look at the
select data from the first timepoint in six trials for participant
number 118. We can see that our seven variables contain the participant
identifier (<code>pNum</code>), the timepoint of the trial
(<code>time</code>), the left eye x and y coordinates
(<code>left_x</code> and <code>left_y</code>), the right eye coordinates
(<code>right_x</code> and <code>right_y</code>), as well as a trial
identifier (<code>trial</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span><span class="op">[</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">pNum</span> <span class="op">==</span> <span class="fl">118</span> <span class="op">&amp;</span> <span class="va">data</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,<span class="op">]</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">##   pNum   time left_x left_y right_x right_y trial</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 118       0   909.   826.   <span style="text-decoration: underline;">1</span>003.    808.     1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 118       0   920.   777.    995.    763.     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 118       0    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 118       0   910.   811.    993.    812.     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 118       0    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 118       0   931.   805.   <span style="text-decoration: underline;">1</span>010.    802.     6</span></span></code></pre>
<p>A good first step is to combine the left and right eye x and y
coordinates to get a single pair of [x,y] coordinates for each
timepoint. The eyetools function <code><a href="../reference/combine_eyes.html">combine_eyes()</a></code> can do this
for us. The method parameter gives the option to either “average” the
two eyes, or we can use the “best_eye”. For “average”, the result is
based on the average of the two eyes for each sample, or for samples
where there is data from only a single eye, that eye is used. For
“best_eye”, a summary of the proportion of missing samples is computed,
and the eye with the fewest missing samples is used.</p>
<p>Here we use the default parameter “average”. Important to note is
that all the eyetool functions operate on data from a single
participant, and so in order to process data from multiple participants,
it is good practice to combine these functions using
<code>lapply</code>. As the functions require data to be a single
participant, we will keep the data in list format until the end.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">data</span><span class="op">$</span><span class="va">pNum</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dataIn</span><span class="op">)</span> <span class="op">{</span></span>
<span>          </span>
<span>  <span class="va">dataIn_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_eyes.html">combine_eyes</a></span><span class="op">(</span><span class="va">dataIn</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span>
<span>          </span>
<span>  <span class="co">#cbind(pNum = dataIn$pNum, dataIn_combined) # return the combined data with the participant identifier too</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The above code returns a list of three elements, and if we take a
look at just one participant, we are returned with a dataframe that has
x and y variables in place of the left_* and right_* variables. This is
the data format expected by many of the other eyetools functions: time,
x, y, and trial.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># participant 118</span></span></code></pre></div>
<pre><code><span><span class="co">##   time        x        y trial</span></span>
<span><span class="co">## 1    0 955.8583 816.5646     1</span></span>
<span><span class="co">## 2    3 956.5178 820.6221     1</span></span>
<span><span class="co">## 3    7 960.7383 819.7616     1</span></span>
<span><span class="co">## 4   10 956.9727 815.3331     1</span></span>
<span><span class="co">## 5   13 958.6214 814.0815     1</span></span>
<span><span class="co">## 6   17 956.0035 814.1564     1</span></span></code></pre>
<p>The next stage of the process would be to remove missing data within
continuous streams of eye data which are likely to be caused by
blinking. We can do this using the <code><a href="../reference/interpolate.html">interpolate()</a></code> function.
The maxgap parameter specifies the maximum number of consecutive NAs to
fill. Any longer gaps will be left unchanged. This is set as default to
25. The method parameter can either be “approx” (default) or “spline”
which are both calls to <code><a href="https://rdrr.io/pkg/zoo/man/na.approx.html" class="external-link">zoo::na.approx</a></code> and
<code><a href="https://rdrr.io/pkg/zoo/man/na.approx.html" class="external-link">zoo::na.spline</a></code> respectively.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dataIn</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/interpolate.html">interpolate</a></span><span class="op">(</span><span class="va">dataIn</span>, maxgap <span class="op">=</span> <span class="fl">25</span>, method <span class="op">=</span> <span class="st">"approx"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Depending on the experimental design, the predictive and
non-predictive cues used for each trial may be counterbalanced, so
sometimes the predictive cue will show on the left hand side, or
sometimes on the right hand side. For the sake of consistency, it can be
beneficial to normalise the predictive cues to a single side. This can
help in observing patterns in the fixations. We can normalise this data
using the function <code><a href="../reference/conditional_transform.html">conditional_transform()</a></code>. This function
currently allows for a single-dimensional flip across either the
horizontal or vertical midline. It can be used on raw data or fixation
data, provided that variables x,y, and one to specify the counterbalance
are present.</p>
<p>The keen-eyed will notice that the present data does not contain a
variable to specify the counterbalanced positions. This is contained in
a separate dataset that holds the behavioural data, including the
response times, the outcome, accuracy, and <code>cue_order</code> which
tells us whether the predictive cue was on the left (coded as 1) or on
the right (coded as 2).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">##   pNum  trial P_cue NP_cue cue_order correct_out accuracy    RT</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 117       1     2      6         1           2        1 <span style="text-decoration: underline;">6</span>114.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 117       2     1      5         2           1        1 <span style="text-decoration: underline;">3</span>869.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 117       3     2      5         1           2        1 <span style="text-decoration: underline;">4</span>657.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 117       4     1      6         2           1        1 <span style="text-decoration: underline;">3</span>367.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 117       5     2      6         2           2        0 <span style="text-decoration: underline;">5</span>057.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 117       6     1      5         1           1        0 <span style="text-decoration: underline;">7</span>798.</span></span></code></pre>
<p>First we need to combine the two datasets based upon the participant
identifier. We then need to reorder the columns into the
<code>time, x, y, trial</code> format required for future eyetools
functions.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">td</span>, <span class="va">td</span><span class="op">$</span><span class="va">pNum</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dataIn</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">pNum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dataIn</span><span class="op">$</span><span class="va">pNum</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">dataIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">pNum</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataIn</span><span class="op">)</span> <span class="co">#combine the datasets</span></span>
<span>  </span>
<span>  <span class="va">dataIn</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dataIn</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co">#reorder the columns</span></span>
<span>  </span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Once the data has been joined we can use
<code><a href="../reference/conditional_transform.html">conditional_transform()</a></code> to transform the x coordinates
across the midline.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dataIn</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="../reference/conditional_transform.html">conditional_transform</a></span><span class="op">(</span><span class="va">dataIn</span>, </span>
<span>                        flip <span class="op">=</span> <span class="st">"x"</span>, <span class="co">#flip across x midline</span></span>
<span>                        cond_column <span class="op">=</span> <span class="st">"cue_order"</span>, <span class="co">#this column holds the counterbalance information</span></span>
<span>                        cond_values <span class="op">=</span> <span class="st">"2"</span>,<span class="co">#which values in cond_column to flip</span></span>
<span>                        message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co">#suppress message that would otherwise repeat - just says "Flipping across x midline"</span></span>
<span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>An additional step that can be beneficial is to make the eye data
<code><a href="../reference/smoother.html">smoother()</a></code>. This function helps to smooth the gaze data,
removing particularly jerky movements. For now, let’s store the smoothed
data in a new object.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_smooth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dataIn</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="../reference/smoother.html">smoother</a></span><span class="op">(</span><span class="va">dataIn</span>, </span>
<span>           span <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="co"># default setting. This controls the degree of smoothing</span></span>
<span>  </span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The below plot shows the difference between the raw and smoothed
data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw</span> <span class="op">&lt;-</span>  <span class="co"># participant 118, trial 5</span></span>
<span></span>
<span><span class="va">smooth</span> <span class="op">&lt;-</span> <span class="va">data_smooth</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">data_smooth</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">trial</span> <span class="op">==</span> <span class="fl">5</span>,<span class="op">]</span> <span class="co"># participant 118, trial 5</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">raw</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">smooth</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="fixation-detection">Fixation Detection<a class="anchor" aria-label="anchor" href="#fixation-detection"></a>
</h2>
<p>In this next stage, we can start to explore the functions available
for determining fixations within the data. The two main functions here
are <code><a href="../reference/fixation_dispersion.html">fixation_dispersion()</a></code> and <code><a href="../reference/fixation_VTI.html">fixation_VTI()</a></code>.
Alongside these, is the option to <code><a href="../reference/compare_algorithms.html">compare_algorithms()</a></code>
which produces a small number of metrics and plots to help visualise the
two fixation algorithms. We will first demonstrate and explain the two
algorithms before demonstrating <code><a href="../reference/compare_algorithms.html">compare_algorithms()</a></code> as
this relies on the two fixation algorithms.</p>
<div class="section level3">
<h3 id="dispersion-algorithm">Dispersion Algorithm<a class="anchor" aria-label="anchor" href="#dispersion-algorithm"></a>
</h3>
<p><code><a href="../reference/fixation_dispersion.html">fixation_dispersion()</a></code> detects fixations by assessing the
dispersion of the eye position using a method similar to that proposed
by Salvucci and Goldberg (1996)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Salvucci, D. D., &amp;amp; Goldberg, J. H. (2000).
Identifying fixations and saccades in eye-tracking protocols.
Proceedings of the Symposium on Eye Tracking Research &amp;amp; Applications
- ETRA ’00, 71–78.&lt;/p&gt;"><sup>1</sup></a>. Evaluates the maximum dispersion
(distance) between x/y coordinates across a window of data. Looks for
sufficient periods in which this maximum dispersion is below the
specified dispersion tolerance. NAs are considered breaks in the data
and are not permitted within a valid fixation period. By default, it
runs the interpolation algorithm and this can be switched off using the
relevant parameter.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fixations_disp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data_smooth</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dataIn</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="../reference/fixation_dispersion.html">fixation_dispersion</a></span><span class="op">(</span><span class="va">dataIn</span>,</span>
<span>                      min_dur <span class="op">=</span> <span class="fl">150</span>, <span class="co"># Minimum duration (in milliseconds) of period over which fixations are assessed</span></span>
<span>                      disp_tol <span class="op">=</span> <span class="fl">100</span>, <span class="co"># Maximum tolerance (in pixels) for the dispersion of values allowed over fixation period</span></span>
<span>                      run_interp <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># the default is true, but we have already run interpolate()</span></span>
<span>                      NA_tol <span class="op">=</span> <span class="fl">0.25</span>, <span class="co"># the proportion of NAs tolerated within any window of samples that is evaluated as a fixation</span></span>
<span>                      progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># whether to display a progress bar or not, when running multiple participants </span></span>
<span>                                        <span class="co"># this is best set to false as it presents a bar for each participant</span></span>
<span>  </span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The resultant data output from <code><a href="../reference/fixation_dispersion.html">fixation_dispersion()</a></code>
presents data by trial and fixation. It gives the start and end time for
these fixations along with their duration and the x,y coordinates for
the entry of the fixation.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fixations_disp</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># show sample of output data for participant 118</span></span></code></pre></div>
<pre><code><span><span class="co">##   trial fix_n start  end duration    x   y prop_NA min_dur disp_tol</span></span>
<span><span class="co">## 1     1     1   213  363      150  933 595       0     150      100</span></span>
<span><span class="co">## 2     1     2   367  623      256  977 531       0     150      100</span></span>
<span><span class="co">## 3     1     3   870 1136      266 1312 782       0     150      100</span></span>
<span><span class="co">## 4     1     4  1726 2013      287  967 215       0     150      100</span></span>
<span><span class="co">## 5     1     5  2373 2570      197  410 796       0     150      100</span></span>
<span><span class="co">## 6     1     6  3140 3293      153 1002 176       0     150      100</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="vti-algorithm">VTI Algorithm<a class="anchor" aria-label="anchor" href="#vti-algorithm"></a>
</h3>
<p>The <code><a href="../reference/fixation_VTI.html">fixation_VTI()</a></code> function operates differently to
<code><a href="../reference/fixation_dispersion.html">fixation_dispersion()</a></code>. It determines fixations by assessing
the velocity of eye-movements, using a method that is similar to that
proposed by Salvucci &amp; Goldberg (1996). Applies the algorithm used
in <code>VTI_saccade()</code> and removes the identified saccades before
assessing whether separated fixations are outside of the dispersion
tolerance. If they are outside of this tolerance, the fixation is
treated as a new fixation regardless of the length of saccade separating
them. Compared to <code><a href="../reference/fixation_dispersion.html">fixation_dispersion()</a></code>,
<code><a href="../reference/fixation_VTI.html">fixation_VTI()</a></code> is more conservative in determining a
fixation as smaller saccades are discounted and the resulting data is
treated as a continued fixation (assuming it is within the pixel
tolerance set by disp_tol).</p>
<p>In simple terms, <code><a href="../reference/fixation_VTI.html">fixation_VTI()</a></code> calculates the saccades
within the data and says the inverse to a saccade should be treated as a
fixation. To avoid eye gaze drift, it applies a dispersion tolerance
parameter as well to ensure that fixations can be appropriately
localised to an x,y coordinate pair. One current limitation to
<code><a href="../reference/fixation_VTI.html">fixation_VTI()</a></code> that is not present in
<code><a href="../reference/fixation_dispersion.html">fixation_dispersion()</a></code> is the need for data to be complete
with no NAs present, as it cannot compute the inverse saccades.</p>
<p>The <code><a href="../reference/fixation_VTI.html">fixation_VTI()</a></code> works best on unsmoothed data (with
default settings), as the smoothing process alters the velocity of the
eye movement. Lower values for the threshold parameter may allow for
fixations to be suitably detected with smooth data.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fixations_VTI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dataIn</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">dataIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">dataIn</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="../reference/fixation_VTI.html">fixation_VTI</a></span><span class="op">(</span><span class="va">dataIn</span>,</span>
<span>               threshold <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                      min_dur <span class="op">=</span> <span class="fl">150</span>, <span class="co"># Minimum duration (in milliseconds) of period over which fixations are assessed</span></span>
<span>                      min_dur_sac <span class="op">=</span> <span class="fl">20</span>, <span class="co"># Minimum duration (in milliseconds) for saccades to be determined</span></span>
<span>                      disp_tol <span class="op">=</span> <span class="fl">100</span>, <span class="co"># Maximum tolerance (in pixels) for the dispersion of values allowed over fixation period</span></span>
<span>                      run_interp <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># the default is true, but we have already run interpolate()</span></span>
<span>                      smooth <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># already run above</span></span>
<span>                      progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># whether to display a progress bar or not, when running multiple participants </span></span>
<span>                                        <span class="co"># this is best set to false as it presents a bar for each participant</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fixations_VTI</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># show sample of output data for participant 118</span></span></code></pre></div>
<pre><code><span><span class="co">##   trial fix_n start  end duration         x        y min_dur disp_tol</span></span>
<span><span class="co">## 1     1     1     0  177      177  959.3563 812.8221     150      100</span></span>
<span><span class="co">## 2     1     2   200  430      230  961.6743 583.7324     150      100</span></span>
<span><span class="co">## 3     1     3   447  747      300  959.6222 475.9596     150      100</span></span>
<span><span class="co">## 4     1     4   793 1183      390 1378.0252 835.5142     150      100</span></span>
<span><span class="co">## 5     1     5  1220 1716      496  980.2503 501.3017     150      100</span></span>
<span><span class="co">## 6     1     6  1750 2190      440  955.1472 168.6481     150      100</span></span></code></pre>
<div class="section level4">
<h4 id="saccades">Saccades<a class="anchor" aria-label="anchor" href="#saccades"></a>
</h4>
<p>This is also a sensible point to briefly highlight the underlying
saccade detection process. This can be accessed directly using
<code><a href="../reference/saccade_VTI.html">saccade_VTI()</a></code>. This uses the velocity threshold algorithm
from Salvucci &amp; Goldberg (1996) to determine saccadic eye movements.
It calculates the length of a saccade based on the velocity of the eye
being above a certain threshold.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">saccades</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/saccade_VTI.html">saccade_VTI</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">saccades</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   trialNumber sac_n start  end duration  origin_x origin_y terminal_x</span></span>
<span><span class="co">## 1           1     1   747  790       43  995.1087 502.8802  1347.1290</span></span>
<span><span class="co">## 2           1     2  1183 1216       33 1369.7478 797.0665  1015.8566</span></span>
<span><span class="co">## 3           1     3  2193 2243       50  870.6509 235.9011   412.1774</span></span>
<span><span class="co">## 4           1     4  2690 2750       60  402.1515 787.2293   947.2018</span></span>
<span><span class="co">## 5           1     5  3676 3733       57  972.3343 123.4475   447.0780</span></span>
<span><span class="co">## 6           1     6  4223 4279       56  402.0509 759.8224   946.9947</span></span>
<span><span class="co">##   terminal_y mean_velocity peak_velocity</span></span>
<span><span class="co">## 1   808.0427      272.2081      396.1462</span></span>
<span><span class="co">## 2   572.8536      316.8887      454.1960</span></span>
<span><span class="co">## 3   815.9587      387.1401      626.0232</span></span>
<span><span class="co">## 4   362.6627      302.5972      470.1270</span></span>
<span><span class="co">## 5   773.0141      374.2626      677.4759</span></span>
<span><span class="co">## 6   344.4058      315.0435      528.9341</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="comparing-the-algorithms">Comparing the algorithms<a class="anchor" aria-label="anchor" href="#comparing-the-algorithms"></a>
</h3>
<p>As mentioned above, a supplementary function exists to compare the
two fixation algorithms, the imaginatively named
<code><a href="../reference/compare_algorithms.html">compare_algorithms()</a></code>. To demonstrate this, we apply it
against a reduced dataset of five unsmoothed trials from one
participant. It takes a combination of the parameters from both the
fixation algorithms, and by default always prints a summary table that
is also stored in the returned list. It is recommended to store this in
an object as the output can be quite long.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_subset</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">trial</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">data_subset</span> <span class="op">&lt;-</span> <span class="va">data_subset</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="co">#keep only time, x, y, and trial</span></span>
<span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_algorithms.html">compare_algorithms</a></span><span class="op">(</span><span class="va">data_subset</span>,</span>
<span>                                 plot_fixations <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 print_summary <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 sample_rate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                 threshold <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                 min_dur <span class="op">=</span> <span class="fl">150</span>,</span>
<span>                                 min_dur_sac <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                 disp_tol <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                 NA_tol <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                                 run_interp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 smooth <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-18-1.png" width="700"></p>
<pre><code><span><span class="co">##    algorithm trial  percent fix_n    corr.r corr.p   corr.t</span></span>
<span><span class="co">## 1        vti     1 91.08690    25 0.5718116      0 44.28582</span></span>
<span><span class="co">## 2 dispersion     1 91.35925    38 0.5718116      0 44.28582</span></span></code></pre>
<p>And for the smoothed data as a comparison</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_subset_smooth</span> <span class="op">&lt;-</span> <span class="va">data_smooth</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">data_smooth</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">trial</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">data_subset_smooth</span> <span class="op">&lt;-</span> <span class="va">data_subset_smooth</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="co">#keep only time, x, y, and trial</span></span>
<span></span>
<span><span class="va">comparison_smooth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_algorithms.html">compare_algorithms</a></span><span class="op">(</span><span class="va">data_subset_smooth</span>,</span>
<span>                                 plot_fixations <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 print_summary <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 sample_rate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                 threshold <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                 min_dur <span class="op">=</span> <span class="fl">150</span>,</span>
<span>                                 min_dur_sac <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                 disp_tol <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                 NA_tol <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                                 run_interp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 smooth <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-19-1.png" width="700"></p>
<pre><code><span><span class="co">##    algorithm trial  percent fix_n     corr.r       corr.p   corr.t</span></span>
<span><span class="co">## 1        vti     1 97.44986     4 0.06776173 1.631872e-05 4.315322</span></span>
<span><span class="co">## 2 dispersion     1 55.75638    29 0.06776173 1.631872e-05 4.315322</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="areas-of-interest">Areas of Interest<a class="anchor" aria-label="anchor" href="#areas-of-interest"></a>
</h2>
<p>Finally, once we have preprocessed the data and collected our
fixation data (we will proceed using the <code>fixations_disp</code>
dataset), we can start looking at Areas of Interest (AOIs) and then
plots of the fixations.</p>
<p>For the <code>AOI_</code> “family” of functions, we need to specify
where our AOIs were presented on the screen. This will enable us to
determine when a participant enters or exits these areas.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set areas of interest</span></span>
<span><span class="va">AOI_areas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">AOI_areas</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"width_radius"</span>, <span class="st">"height"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AOI_areas</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">410</span>, <span class="fl">840</span>, <span class="fl">400</span>, <span class="fl">300</span><span class="op">)</span> <span class="co"># Left cue</span></span>
<span><span class="va">AOI_areas</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1510</span>, <span class="fl">840</span>, <span class="fl">400</span>, <span class="fl">300</span><span class="op">)</span> <span class="co"># Right cue</span></span>
<span><span class="va">AOI_areas</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">960</span>, <span class="fl">270</span>, <span class="fl">300</span>, <span class="fl">500</span><span class="op">)</span> <span class="co"># outcomes</span></span>
<span></span>
<span><span class="va">AOI_areas</span></span></code></pre></div>
<pre><code><span><span class="co">##      x   y width_radius height</span></span>
<span><span class="co">## 1  410 840          400    300</span></span>
<span><span class="co">## 2 1510 840          400    300</span></span>
<span><span class="co">## 3  960 270          300    500</span></span></code></pre>
<p>The <code><a href="../reference/AOI_seq.html">AOI_seq()</a></code> function analyses the sequence of entries
into defined AOI regions across trials. Works with fixation data or raw
data as the input.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_AOI_sequence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AOI_seq.html">AOI_seq</a></span><span class="op">(</span><span class="va">fixations_disp</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="co"># just participant 118, otherwise incorporate into lapply() as above</span></span>
<span>        <span class="va">AOI_areas</span>,</span>
<span>        AOI_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        sample_rate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">data_AOI_sequence</span><span class="op">[</span><span class="va">data_AOI_sequence</span><span class="op">$</span><span class="va">trial</span> <span class="op">==</span> <span class="fl">3</span>,<span class="op">]</span> <span class="co"># a one trial sample output</span></span></code></pre></div>
<pre><code><span><span class="co">##    trial AOI entry_n</span></span>
<span><span class="co">## 21     3   3       1</span></span>
<span><span class="co">## 22     3   2       2</span></span>
<span><span class="co">## 23     3   3       3</span></span>
<span><span class="co">## 24     3   1       4</span></span>
<span><span class="co">## 25     3   3       5</span></span></code></pre>
<p><code><a href="../reference/AOI_time.html">AOI_time()</a></code> analyses the total time on defined AOI
regions across trials. Works with fixation and raw data as the input
(must use one or the other, not both). This gives a cumulative total
time spent for each trial.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_AOI_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AOI_time.html">AOI_time</a></span><span class="op">(</span>fix_data <span class="op">=</span> <span class="va">fixations_disp</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="co"># just participant 118, otherwise incorporate into lapply() as above</span></span>
<span>        AOIs <span class="op">=</span> <span class="va">AOI_areas</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_AOI_time</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   trial AOI_1 AOI_2 AOI_3</span></span>
<span><span class="co">## 1     1   866  2638  2939</span></span>
<span><span class="co">## 2     2   723   854  2614</span></span>
<span><span class="co">## 3     3   343   356  2251</span></span>
<span><span class="co">## 4     4  2345  1430  1255</span></span>
<span><span class="co">## 5     5   537     0  1708</span></span>
<span><span class="co">## 6     6   563   426  2022</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plotting-functions">Plotting Functions<a class="anchor" aria-label="anchor" href="#plotting-functions"></a>
</h2>
<p>Finally, eyetools contains two <code>plot_</code> functions,
<code><a href="../reference/plot_seq.html">plot_seq()</a></code> and <code><a href="../reference/plot_spatial.html">plot_spatial()</a></code>.</p>
<p><code><a href="../reference/plot_seq.html">plot_seq()</a></code> is a tool for visualising the timecourse of
raw data over a single trial. If data from multiple trials are present,
then a single trial will be sampled at random. Alternatively, the
trial_number can be specified. Data can be plotted across the whole
trial, or can be split into bins to present distinct plots for each time
window.</p>
<p>The most simple use is to just pass it raw data:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_seq.html">plot_seq</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, trial_number <span class="op">=</span> <span class="fl">57</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-23-1.png" width="700"></p>
<p>But the parameters of <code><a href="../reference/plot_seq.html">plot_seq()</a></code> can help exploration be
more informative. We can in background images or the AOIs</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_seq.html">plot_seq</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, trial_number <span class="op">=</span> <span class="fl">57</span>, bg_image <span class="op">=</span> <span class="st">"data/HCL_sample_image.jpg"</span><span class="op">)</span> <span class="co"># add background image</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_seq.html">plot_seq</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, trial_number <span class="op">=</span> <span class="fl">57</span>, AOIs <span class="op">=</span> <span class="va">AOI_areas</span><span class="op">)</span> <span class="co"># add AOIs</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-24-2.png" width="700"></p>
<p>You also have the option to split the time into bins to reduce the
amount of data plotted</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_seq.html">plot_seq</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, trial_number <span class="op">=</span> <span class="fl">57</span>, AOIs <span class="op">=</span> <span class="va">AOI_areas</span>, bin_time <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-25-1.png" width="700"></p>
<p>The other plotting function is <code><a href="../reference/plot_spatial.html">plot_spatial()</a></code>, which is
a tool for visualising raw eye-data, processed fixations, and saccades.
Fixations can be labeled in the order they were made. You can also
overlay areas of interest (AOIs) and customise the resolution.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_spatial.html">plot_spatial</a></span><span class="op">(</span>raw_data <span class="op">=</span> <span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-26-1.png" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot the spatial data for trial 57 only. </span></span>
<span><span class="fu"><a href="../reference/plot_spatial.html">plot_spatial</a></span><span class="op">(</span>fix_data <span class="op">=</span> <span class="va">fixations_VTI</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">fixations_VTI</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">trial</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">57</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># a LOT of fixations, let's take a sample</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-26-2.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_spatial.html">plot_spatial</a></span><span class="op">(</span>sac_data <span class="op">=</span> <span class="va">saccades</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/unnamed-chunk-26-3.png" width="700"></p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Beesley Tom, Ivory Matthew.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
